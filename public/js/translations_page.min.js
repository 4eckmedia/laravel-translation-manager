var CLIP_TEXT,YANDEX_TRANSLATOR_KEY,URL_YANDEX_TRANSLATOR_KEY,PRIMARY_LOCALE,CURRENT_LOCALE,TRANSLATING_LOCALE,URL_TRANSLATOR_GROUP,URL_TRANSLATOR_ALL,xtranslateText,xtranslateService;jQuery(document).ready(function($){function t(t,e,a){if(t.length){var n,i,s=e.text(),r=e.data("disable-with");n=t.length,i=0;var l,o=function(t){a(t.srcText,function(a,n){if(""!==a){var i=$.ajax({type:"POST",url:t.dataUrl,data:{name:t.dataName,value:a},success:function(n){"ok"===n.status?(t.dstElem.removeClass("editable-empty status-0"),t.dstElem.addClass("status-1"),t.dstElem.text(a),t.dstElem.editable("setValue",a,!1)):(e.removeAttr("disabled"),e.text(s))},encode:!0});i.done(function(){l()}),i.fail(function(){e.removeAttr("disabled"),e.text(s)})}else e.removeAttr("disabled"),e.text(s)})};l=function(){t.length?(i++,o(t.pop()),e.attr("disabled","disabled"),e.text(r+" "+i+" / "+n)):(e.removeAttr("disabled"),e.text(s))};for(var d=0;5>d;d++)l()}}function e(t,e,a){return function(){var n={id:null},i={id:null},s=function(t,e,a){return function(){"both"===e.css("resize")?(e.outerWidth(t.outerWidth()),e.outerHeight(t.outerHeight())):"horizontal"===e.css("resize")?e.outerWidth(t.outerWidth()):"vertical"===e.css("resize")&&e.outerHeight(t.outerHeight()),a.id&&(clearTimeout(a.id),a.id=null)}};a&&$(window).on("mousemove",function(a){a.target===t[0]?(n.id&&(clearTimeout(n.id),n.id=null),n.id=setTimeout(s(t,e,n),1e3/30)):a.target===e[0]&&(i.id&&(clearTimeout(i.id),i.id=null),i.id=setTimeout(s(e,t,i),1e3/30))}),$(window).on("mouseup",function(a){null!==n.id&&(clearTimeout(n.id),n.id=null),a.target===t[0]?s(t,e,n)():a.target===e[0]&&s(e,t,i)()})}}$.ajaxPrefilter(function(t){t.crossDomain||(t.headers={"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")})}),$(".group-select").on("change",function(){var t=$(this).val();t?window.location.href=URL_TRANSLATOR_GROUP+$(this).val():window.location.href=URL_TRANSLATOR_ALL}),$.ajax({type:"POST",url:URL_YANDEX_TRANSLATOR_KEY,data:{},success:function(t){"ok"===t.status&&(YANDEX_TRANSLATOR_KEY=t.yandex_key)},encode:!0}),$("a.delete-key").on("ajax:success",function(t,e){var a=$(this).closest("tr");a.addClass("deleted-translation"),$(this).addClass("hidden"),a.find("a.undelete-key").first().removeClass("hidden")}),$("a.undelete-key").on("ajax:success",function(t,e){var a=$(this).closest("tr");a.removeClass("deleted-translation"),$(this).addClass("hidden"),a.find("a.delete-key").first().removeClass("hidden")});var a=function(t){var e=$("div.success-"+t),a=e.html();$(".form-"+t).on("ajax:success",function(t,n){e.html(a.replace(/:count\b/,n.counter)),e.closest("div.alert").slideDown()})};a("import-group"),a("import-all"),a("find"),$(".form-publish-group").on("ajax:success",function(t,e){if("errors"===e.status){var a=$("div.errors-alert"),n=e.errors;a.html("<p>"+n.join("</p>\n<p>")+"</p>\n"),a.closest("div.alert").slideDown()}else $("div.success-publish").closest("div.alert").slideDown(),$("tr.deleted-translation").remove()}),$(".form-publish-all").on("ajax:success",function(t,e){if("errors"===e.status){var a=$("div.errors-alert"),n=e.errors;a.html("<p>"+n.join("</p>\n<p>")+"</p>\n"),a.closest("div.alert").slideDown()}else $("div.success-publish-all").closest("div.alert").slideDown(),$("tr.deleted-translation").remove()}),$("#form-keyops").on("ajax:success",function(t,e){var a=$("#wildcard-keyops-results").first();a.html(e),a.find(".vsch_editable").vsch_editable()});var n=$("#searchModal").first();n.on("shown.bs.modal",function(t,e,a,i){n.find("#search-form-text").first().focus()}),n.on("ajax:success",function(t,e,a,i){var s=n.find(".results");s.html(e),s.find(".vsch_editable").vsch_editable()}),$("#translate-current-primary").on("click",function(){var t=$("#current-text").first(),e=t[0].value;xtranslateService(TRANSLATING_LOCALE,e,PRIMARY_LOCALE,function(t){var e=$("#primary-text").first();e.length&&e.val(t)})}),$("#translate-primary-current").on("click",function(){var t=$("#primary-text").first(),e=t[0].value;xtranslateService(PRIMARY_LOCALE,e,TRANSLATING_LOCALE,function(t){var e=$("#current-text").first();e.length&&e.val(t)})}),$("#db-connection").on("change",function(){$("#form-interface-locale")[0].submit()}),$("#interface-locale").on("change",function(){$("#form-interface-locale")[0].submit()}),$("#translating-locale").on("change",function(){$("#form-interface-locale")[0].submit()}),$("#primary-locale").on("change",function(){$("#form-interface-locale")[0].submit()}),$("#display-locale-all").on("click",function(t){t.preventDefault(),$(".display-locale").prop("checked",!0)}),$("#display-locale-none").on("click",function(t){t.preventDefault(),$(".display-locale").prop("checked",!1)}),$("#show-all").on("click",function(t){var e=$("#translations");e.find("tr").removeClass("hidden")}),$("#show-empty").on("click",function(t){var e=$("#translations").find("tbody").first();e.find("tr").addClass("hidden"),e.find("tr.has-empty-translation").removeClass("hidden")}),$("#show-nonempty").on("click",function(t){var e=$("#translations").find("tbody").first();e.find("tr").addClass("hidden"),e.find("tr.has-nonempty-translation").removeClass("hidden")}),$("#show-deleted").on("click",function(t){var e=$("#translations").find("tbody").first();e.find("tr").addClass("hidden"),e.find("tr.deleted-translation").removeClass("hidden")}),$("#show-changed").on("click",function(t){var e=$("#translations").find("tbody").first();e.find("tr").addClass("hidden"),e.find("tr.has-changed-translation").removeClass("hidden")}),$("div.alert-hideable").each(function(){var t=$(this),e=t.find("button.close").first();e.length&&e.on("click",function(){t.slideUp()})});var i=$("#auto-translate");i.on("click",function(e){e.preventDefault(),e.stopPropagation();var a=[];$(".auto-translatable").each(function(){var t=$(this).parent().find(".vsch_editable");if(t.length>1){var e=$(t[0]),n=$(t[1]);n.length&&e.length&&n.hasClass("editable-empty")&&!e.hasClass("editable-empty")&&a.push({srcText:e.text(),dataUrl:n.data("url"),dataName:n.data("name"),dstElem:n})}}),function(e,n,i){t(a,i,function(t,a){xtranslateText(xtranslateService,e,t,n,a)})}(PRIMARY_LOCALE,TRANSLATING_LOCALE,i)});var s=$("#auto-fill");s.on("click",function(e){var a=[];e.preventDefault(),e.stopPropagation(),$(".auto-fillable").each(function(){var t=$(this).find("a.vsch_editable.editable-empty");t.length&&a.push({srcText:t.data("name").substr(PRIMARY_LOCALE.length+1),dataUrl:t.data("url"),dataName:t.data("name"),dstElem:t})}),function(e){t(a,e,function(t,e){var a=/^.*\.|-|_/g,n=t.replace(a," ").toCapitalCase().trim();e(n,"")})}(s)});var r=$("#form-addkeys").first();e(r.find("textarea[name=keys]"),r.find("textarea[name=suffixes]"),!0)(),e($("#primary-text"),$("#current-text"),!0)(),e($("#srckeys"),$("#dstkeys"),!0)()});