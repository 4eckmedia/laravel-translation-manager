var CLIP_TEXT,YANDEX_TRANSLATOR_KEY,URL_YANDEX_TRANSLATOR_KEY,PRIMARY_LOCALE,CURRENT_LOCALE,TRANSLATING_LOCALE,URL_TRANSLATOR_GROUP,URL_TRANSLATOR_ALL,xtranslateText,xtranslateService;jQuery(document).ready(function($){function e(e,t,a){if(e.length){var n,i,s=t.text(),r=t.data("disable-with");n=e.length,i=0;var l,o=function(e){a(e.srcText,function(a,n){if(""!==a){var i=$.ajax({type:"POST",url:e.dataUrl,data:{name:e.dataName,value:a},success:function(n){"ok"===n.status?(e.dstElem.removeClass("editable-empty status-0"),e.dstElem.addClass("status-1"),e.dstElem.text(a),e.dstElem.editable("setValue",a,!1)):(t.removeAttr("disabled"),t.text(s))},encode:!0});i.done(function(){l()}),i.fail(function(){t.removeAttr("disabled"),t.text(s)})}else t.removeAttr("disabled"),t.text(s)})};l=function(){e.length?(i++,o(e.pop()),t.attr("disabled","disabled"),t.text(r+" "+i+" / "+n)):(t.removeAttr("disabled"),t.text(s))};for(var c=0;5>c;c++)l()}}function t(e,t,a){return function(){var n={id:null},i={id:null},s=function(e,t,a){return function(){"both"===t.css("resize")?(t.outerWidth(e.outerWidth()),t.outerHeight(e.outerHeight())):"horizontal"===t.css("resize")?t.outerWidth(e.outerWidth()):"vertical"===t.css("resize")&&t.outerHeight(e.outerHeight()),a.id&&(clearTimeout(a.id),a.id=null)}};a&&$(window).on("mousemove",function(a){a.target===e[0]?(n.id&&(clearTimeout(n.id),n.id=null),n.id=setTimeout(s(e,t,n),1e3/30)):a.target===t[0]&&(i.id&&(clearTimeout(i.id),i.id=null),i.id=setTimeout(s(t,e,i),1e3/30))}),$(window).on("mouseup",function(a){null!==n.id&&(clearTimeout(n.id),n.id=null),a.target===e[0]?s(e,t,n)():a.target===t[0]&&s(t,e,i)()})}}$.ajaxPrefilter(function(e){e.crossDomain||(e.headers={"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")})}),$(".group-select").on("change",function(){var e=$(this).val();e?window.location.href=URL_TRANSLATOR_GROUP+$(this).val():window.location.href=URL_TRANSLATOR_ALL}),$.ajax({type:"POST",url:URL_YANDEX_TRANSLATOR_KEY,data:{},success:function(e){"ok"===e.status&&(YANDEX_TRANSLATOR_KEY=e.yandex_key)},encode:!0}),$("a.delete-key").on("ajax:success",function(e,t){var a=$(this).closest("tr");a.addClass("deleted-translation"),$(this).addClass("hidden"),a.find("a.undelete-key").first().removeClass("hidden")}),$("a.undelete-key").on("ajax:success",function(e,t){var a=$(this).closest("tr");a.removeClass("deleted-translation"),$(this).addClass("hidden"),a.find("a.delete-key").first().removeClass("hidden")}),$(".form-import").on("ajax:success",function(e,t){var a=$("div.success-import-group");a.html(a.html().replace(/:count\b/,t.counter)),a.slideDown()}),$(".form-import-all").on("ajax:success",function(e,t){var a=$("div.success-import-all");a.html(a.html().replace(/:count\b/,t.counter)),a.slideDown()}),$(".form-find").on("ajax:success",function(e,t){var a=$("div.success-find");a.html(a.html().replace(/:count\b/,t.counter)),a.slideDown()}),$(".form-publish-group").on("ajax:success",function(e,t){$("div.success-publish").slideDown(),$("tr.deleted-translation").remove()}),$(".form-publish-all").on("ajax:success",function(e,t){$("div.success-publish-all").slideDown(),$("tr.deleted-translation").remove()}),$("#form-keyops").on("ajax:success",function(e,t){var a=$("#wildcard-keyops-results").first();a.html(t),a.find(".vsch_editable").vsch_editable()});var a=$("#searchModal").first();a.on("shown.bs.modal",function(e,t,n,i){a.find("#search-form-text").first().focus()}),a.on("ajax:success",function(e,t,n,i){var s=a.find(".results");s.html(t),s.find(".vsch_editable").vsch_editable()}),$("#translate-current-primary").on("click",function(){var e=$("#current-text").first(),t=e[0].value;xtranslateService(TRANSLATING_LOCALE,t,PRIMARY_LOCALE,function(e){var t=$("#primary-text").first();t.length&&t.val(e)})}),$("#translate-primary-current").on("click",function(){var e=$("#primary-text").first(),t=e[0].value;xtranslateService(PRIMARY_LOCALE,t,TRANSLATING_LOCALE,function(e){var t=$("#current-text").first();t.length&&t.val(e)})}),$("#interface-locale").on("change",function(){$("#form-interface-locale")[0].submit()}),$("#translating-locale").on("change",function(){$("#form-interface-locale")[0].submit()}),$("#primary-locale").on("change",function(){$("#form-interface-locale")[0].submit()}),$("#display-locale-all").on("click",function(e){e.preventDefault(),$(".display-locale").prop("checked",!0)}),$("#display-locale-none").on("click",function(e){e.preventDefault(),$(".display-locale").prop("checked",!1)});var n=$("#auto-translate");n.on("click",function(t){t.preventDefault(),t.stopPropagation();var a=[];$(".auto-translatable").each(function(){var e=$(this).parent().find(".vsch_editable");if(e.length>1){var t=$(e[0]),n=$(e[1]);n.length&&t.length&&n.hasClass("editable-empty")&&!t.hasClass("editable-empty")&&a.push({srcText:t.text(),dataUrl:n.data("url"),dataName:n.data("name"),dstElem:n})}}),function(t,n,i){e(a,i,function(e,a){xtranslateText(xtranslateService,t,e,n,a)})}(PRIMARY_LOCALE,TRANSLATING_LOCALE,n)});var i=$("#auto-fill");i.on("click",function(t){var a=[];t.preventDefault(),t.stopPropagation(),$(".auto-fillable").each(function(){var e=$(this).find("a.vsch_editable.editable-empty");e.length&&a.push({srcText:e.data("name").substr(PRIMARY_LOCALE.length+1),dataUrl:e.data("url"),dataName:e.data("name"),dstElem:e})}),function(t){e(a,t,function(e,t){var a=/^.*\.|-|_/g,n=e.replace(a," ").toCapitalCase().trim();t(n,"")})}(i)});var s=$("#form-addkeys").first();t(s.find("textarea[name=keys]"),s.find("textarea[name=suffixes]"),!0)(),t($("#primary-text"),$("#current-text"),!0)(),t($("#srckeys"),$("#dstkeys"),!0)()});